<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShowRovinci Show - Multiplayer Trivia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 1200px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn-dark {
            background: linear-gradient(135deg, #434343 0%, #000000 100%);
        }

        .role-selection {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .role-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            min-width: 250px;
        }

        .role-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .role-card.solo {
            background: linear-gradient(135deg, #434343 0%, #000000 100%);
            color: white;
        }

        .role-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .input-group {
            margin: 20px 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .game-code {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            margin: 20px 0;
            letter-spacing: 5px;
        }

        .players-list {
            background: #f5f7fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .player-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .player-name {
            font-weight: 600;
            color: #333;
        }

        .player-score {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .question-form {
            background: #f5f7fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .option-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            align-items: center;
        }

        .option-input input[type="text"] {
            flex: 1;
        }

        .option-input input[type="radio"] {
            width: auto;
            margin: 0 10px;
        }

        .question-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .question-display.solo {
            background: linear-gradient(135deg, #434343 0%, #000000 100%);
        }

        .question-text {
            font-size: 1.5em;
            margin-bottom: 30px;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .option-btn {
            background: white;
            color: #333;
            padding: 20px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .option-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .option-btn.correct {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .option-btn.incorrect {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .timer {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: #667eea;
        }

        .timer.warning {
            color: #f5576c;
            animation: pulse 0.5s infinite;
        }

        .timer.solo {
            color: #434343;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .scoreboard {
            margin: 30px 0;
        }

        .scoreboard-item {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            margin: 10px 0;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2em;
        }

        .rank {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            min-width: 80px;
        }

        .topic-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            margin: 5px;
        }

        .topic-badge.solo {
            background: linear-gradient(135deg, #434343 0%, #000000 100%);
        }

        .questions-list {
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .question-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .waiting-message {
            text-align: center;
            font-size: 1.5em;
            color: #667eea;
            margin: 40px 0;
            animation: fadeInOut 2s infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .trophy {
            font-size: 5em;
            text-align: center;
            margin: 20px 0;
        }

        .solo-score-display {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .role-selection {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé≠ ShowRovinci Show</h1>
        <p class="subtitle">The Ultimate Multiplayer Trivia Experience</p>

        <!-- Role Selection Screen -->
        <div id="roleScreen" class="screen active">
            <div class="role-selection">
                <div class="role-card" onclick="selectRole('host')">
                    <div class="role-icon">üë®‚Äçüíº</div>
                    <h2>Host</h2>
                    <p>Create topics, questions, and manage the game</p>
                </div>
                <div class="role-card" onclick="selectRole('player')">
                    <div class="role-icon">üéÆ</div>
                    <h2>Player</h2>
                    <p>Join a game and compete for the top score</p>
                </div>
                <div class="role-card solo" onclick="selectRole('solo')">
                    <div class="role-icon">üíÄ</div>
                    <h2>Solo Mode</h2>
                    <p>Play alone with dark & twisted questions</p>
                </div>
            </div>
        </div>

        <!-- Solo Setup Screen -->
        <div id="soloSetupScreen" class="screen">
            <h2>Solo Mode Setup</h2>
            <div class="input-group">
                <label>Your Name:</label>
                <input type="text" id="soloPlayerName" placeholder="Enter your name">
            </div>
            <div class="input-group">
                <label>Choose Your Poison:</label>
                <select id="soloTopic">
                    <option value="existential">Existential Dread</option>
                    <option value="dark_history">Dark History Facts</option>
                    <option value="weird_deaths">Weird Ways to Die</option>
                    <option value="conspiracy">Conspiracy Theories</option>
                    <option value="apocalypse">End of the World</option>
                </select>
            </div>
            <button class="btn btn-dark" onclick="startSoloGame()">Begin Your Suffering</button>
            <button class="btn btn-secondary" onclick="showScreen('roleScreen')">Back</button>
        </div>

        <!-- Host Setup Screen -->
        <div id="hostSetupScreen" class="screen">
            <h2>Host Setup</h2>
            <div class="input-group">
                <label>Your Name:</label>
                <input type="text" id="hostName" placeholder="Enter your name">
            </div>
            <div class="input-group">
                <label>Game Topic:</label>
                <input type="text" id="gameTopic" placeholder="e.g., Science, History, Movies">
            </div>
            <div class="input-group">
                <label>Number of Players (4-5):</label>
                <select id="maxPlayers">
                    <option value="4">4 Players</option>
                    <option value="5">5 Players</option>
                </select>
            </div>
            <button class="btn" onclick="createGame()">Create Game</button>
            <button class="btn btn-secondary" onclick="showScreen('roleScreen')">Back</button>
        </div>

        <!-- Player Join Screen -->
        <div id="playerJoinScreen" class="screen">
            <h2>Join Game</h2>
            <div class="input-group">
                <label>Your Name:</label>
                <input type="text" id="playerName" placeholder="Enter your name">
            </div>
            <div class="input-group">
                <label>Game Code:</label>
                <input type="text" id="gameCode" placeholder="Enter 6-digit code" maxlength="6">
            </div>
            <button class="btn" onclick="joinGame()">Join Game</button>
            <button class="btn btn-secondary" onclick="showScreen('roleScreen')">Back</button>
        </div>

        <!-- Host Lobby Screen -->
        <div id="hostLobbyScreen" class="screen">
            <h2>Game Lobby</h2>
            <div class="game-code" id="displayGameCode"></div>
            <div class="topic-badge" id="displayTopic"></div>
            <div class="players-list">
                <h3>Players Joined (<span id="playerCount">0</span>/<span id="maxPlayerCount">4</span>)</h3>
                <div id="lobbyPlayersList"></div>
            </div>
            <button class="btn btn-success" onclick="startQuestionCreation()" id="startGameBtn" disabled>Create Questions</button>
        </div>

        <!-- Question Creation Screen -->
        <div id="questionCreationScreen" class="screen">
            <h2>Create Questions</h2>
            <p>Topic: <span class="topic-badge" id="creationTopic"></span></p>
            
            <div class="question-form">
                <div class="input-group">
                    <label>Question:</label>
                    <textarea id="questionText" rows="3" placeholder="Enter your question"></textarea>
                </div>
                
                <div class="input-group">
                    <label>Options (select correct answer):</label>
                    <div class="option-input">
                        <input type="radio" name="correctAnswer" value="0" id="correct0">
                        <input type="text" id="option0" placeholder="Option 1">
                        <label for="correct0" style="display: inline; margin: 0; cursor: pointer;">‚úì</label>
                    </div>
                    <div class="option-input">
                        <input type="radio" name="correctAnswer" value="1" id="correct1">
                        <input type="text" id="option1" placeholder="Option 2">
                        <label for="correct1" style="display: inline; margin: 0; cursor: pointer;">‚úì</label>
                    </div>
                    <div class="option-input">
                        <input type="radio" name="correctAnswer" value="2" id="correct2">
                        <input type="text" id="option2" placeholder="Option 3">
                        <label for="correct2" style="display: inline; margin: 0; cursor: pointer;">‚úì</label>
                    </div>
                    <div class="option-input">
                        <input type="radio" name="correctAnswer" value="3" id="correct3">
                        <input type="text" id="option3" placeholder="Option 4">
                        <label for="correct3" style="display: inline; margin: 0; cursor: pointer;">‚úì</label>
                    </div>
                </div>
                
                <button class="btn" onclick="addQuestion()">Add Question</button>
            </div>

            <div class="questions-list">
                <h3>Questions Added (<span id="questionCount">0</span>)</h3>
                <div id="questionsDisplay"></div>
            </div>

            <button class="btn btn-success" onclick="startGame()" id="startGameBtnFinal" disabled>Start Game (Min 5 questions)</button>
        </div>

        <!-- Player Waiting Screen -->
        <div id="playerWaitingScreen" class="screen">
            <h2>Waiting for Game to Start</h2>
            <div class="waiting-message">‚è≥ Host is preparing questions...</div>
            <div class="players-list">
                <h3>Players in Game:</h3>
                <div id="waitingPlayersList"></div>
            </div>
        </div>

        <!-- Game Play Screen (Host) -->
        <div id="hostGameScreen" class="screen">
            <h2>Question <span id="hostQuestionNumber">1</span></h2>
            <div class="question-display">
                <div class="question-text" id="hostQuestionText"></div>
            </div>
            <div class="timer" id="hostTimer">15</div>
            <div class="players-list">
                <h3>Player Answers:</h3>
                <div id="hostAnswersDisplay"></div>
            </div>
            <button class="btn btn-success" onclick="nextQuestion()" id="nextQuestionBtn" style="display: none;">Next Question</button>
            <button class="btn btn-success" onclick="showResults()" id="showResultsBtn" style="display: none;">Show Results</button>
        </div>

        <!-- Game Play Screen (Player) -->
        <div id="playerGameScreen" class="screen">
            <h2>Question <span id="playerQuestionNumber">1</span></h2>
            <div class="question-display">
                <div class="question-text" id="playerQuestionText"></div>
            </div>
            <div class="timer" id="playerTimer">15</div>
            <div class="options-grid" id="playerOptions"></div>
            <div id="answerFeedback" style="text-align: center; margin-top: 20px; font-size: 1.5em; font-weight: bold;"></div>
        </div>

        <!-- Solo Game Screen -->
        <div id="soloGameScreen" class="screen">
            <h2>Question <span id="soloQuestionNumber">1</span> of <span id="soloTotalQuestions">10</span></h2>
            <div class="topic-badge solo" id="soloTopicDisplay"></div>
            <div class="solo-score-display">Score: <span id="soloScore">0</span></div>
            <div class="question-display solo">
                <div class="question-text" id="soloQuestionText"></div>
            </div>
            <div class="timer solo" id="soloTimer">15</div>
            <div class="options-grid" id="soloOptions"></div>
            <div id="soloAnswerFeedback" style="text-align: center; margin-top: 20px; font-size: 1.5em; font-weight: bold;"></div>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="screen">
            <div class="trophy">üèÜ</div>
            <h2>Final Results</h2>
            <div class="scoreboard" id="finalScoreboard"></div>
            <button class="btn" onclick="location.reload()">New Game</button>
        </div>
    </div>

    <script>
        // Dark and funny questions database
        const darkQuestions = {
            existential: [
                {
                    question: "What percentage of people who have ever lived are currently dead?",
                    options: ["50%", "70%", "93%", "99%"],
                    correct: 2
                },
                {
                    question: "How many years until the sun explodes and we all die?",
                    options: ["1 billion", "5 billion", "10 billion", "Next Tuesday"],
                    correct: 1
                },
                {
                    question: "What's the leading cause of death for people who drink water?",
                    options: ["Drowning", "Death", "Water poisoning", "Existing"],
                    correct: 1
                },
                {
                    question: "How long would you survive in the vacuum of space?",
                    options: ["30 seconds", "2 minutes", "5 minutes", "Long enough to regret it"],
                    correct: 3
                },
                {
                    question: "What's the average number of spiders you swallow while sleeping per year?",
                    options: ["0 (it's a myth)", "8", "15", "Enough to haunt your dreams"],
                    correct: 0
                },
                {
                    question: "How many people die every second globally?",
                    options: ["0.5", "1.8", "5", "Not fast enough"],
                    correct: 1
                },
                {
                    question: "What's inside a black hole?",
                    options: ["Your hopes", "Your dreams", "Nobody knows", "All of the above"],
                    correct: 3
                },
                {
                    question: "How long until the heat death of the universe?",
                    options: ["10^100 years", "Forever", "Tomorrow at 3pm", "Does it matter?"],
                    correct: 0
                },
                {
                    question: "What percentage of your body is just bacteria?",
                    options: ["1%", "10%", "50%", "You're basically a walking meat suit for bacteria"],
                    correct: 2
                },
                {
                    question: "How many of your cells die and are replaced every day?",
                    options: ["Thousands", "Millions", "Billions", "You're basically a different person than yesterday"],
                    correct: 2
                }
            ],
            dark_history: [
                {
                    question: "How many people died building the Great Wall of China?",
                    options: ["10,000", "100,000", "1 million", "Enough to be buried IN the wall"],
                    correct: 3
                },
                {
                    question: "What did Victorian doctors prescribe for hysteria in women?",
                    options: ["Leeches", "Lobotomy", "Vibrators", "All of the above at some point"],
                    correct: 3
                },
                {
                    question: "How long did the shortest war in history last?",
                    options: ["38 minutes", "2 hours", "1 day", "Longer than my last relationship"],
                    correct: 0
                },
                {
                    question: "What did ancient Romans use as mouthwash?",
                    options: ["Wine", "Urine", "Vinegar", "The tears of their enemies"],
                    correct: 1
                },
                {
                    question: "How many people died in the Great Molasses Flood of 1919?",
                    options: ["0", "21", "100", "A sticky situation for sure"],
                    correct: 1
                },
                {
                    question: "What was the Dancing Plague of 1518?",
                    options: ["A party", "People danced until they died", "A medieval dance-off", "The world's worst flash mob"],
                    correct: 1
                },
                {
                    question: "How did Greek philosopher Chrysippus die?",
                    options: ["In battle", "Laughing at his own joke", "Poison", "Old age (boring)"],
                    correct: 1
                },
                {
                    question: "What did people use before toilet paper?",
                    options: ["Leaves", "Corn cobs", "Sponges on sticks", "All of these nightmares"],
                    correct: 3
                },
                {
                    question: "How many people were killed by Napoleon's retreat from Moscow in winter?",
                    options: ["10,000", "100,000", "400,000", "Enough to paint the snow red"],
                    correct: 2
                },
                {
                    question: "What did doctors do during the Black Plague to 'cure' patients?",
                    options: ["Bloodletting", "Whipping", "Covering them in mercury", "Literally everything except what worked"],
                    correct: 3
                }
            ],
            weird_deaths: [
                {
                    question: "How did ancient Greek playwright Aeschylus die?",
                    options: ["Eagle dropped a tortoise on his head", "Poison", "Old age", "Writer's block"],
                    correct: 0
                },
                {
                    question: "What killed more people: vending machines or sharks?",
                    options: ["Sharks", "Vending machines", "Neither", "Your trust issues"],
                    correct: 1
                },
                {
                    question: "How did the inventor of the Segway die?",
                    options: ["Car accident", "Rode a Segway off a cliff", "Natural causes", "Irony overload"],
                    correct: 1
                },
                {
                    question: "What's the most likely way you'll die?",
                    options: ["Heart disease", "Cancer", "Accident", "Embarrassment"],
                    correct: 0
                },
                {
                    question: "How many people have died taking selfies since 2011?",
                    options: ["12", "50", "Over 250", "Not enough apparently"],
                    correct: 2
                },
                {
                    question: "What killed the most people in the 1666 Great Fire of London?",
                    options: ["The fire itself (6 deaths)", "Starvation after", "Rebuilding accidents", "Your expectations"],
                    correct: 0
                },
                {
                    question: "How did Tennessee Williams die?",
                    options: ["Choked on a bottle cap", "Heart attack", "Car crash", "Poetic justice"],
                    correct: 0
                },
                {
                    question: "What's the deadliest animal to humans?",
                    options: ["Sharks", "Lions", "Mosquitoes", "Other humans"],
                    correct: 2
                },
                {
                    question: "How many people die from falling out of bed each year?",
                    options: ["10", "100", "450+", "Sweet dreams!"],
                    correct: 2
                },
                {
                    question: "How did Bruce Lee's son Brandon die?",
                    options: ["Prop gun accident", "Stunt gone wrong", "Illness", "Family curse (seriously)"],
                    correct: 0
                }
            ],
            conspiracy: [
                {
                    question: "What do flat-earthers think is at the edge of the world?",
                    options: ["Ice wall", "Waterfall", "Your hopes and dreams", "Critical thinking"],
                    correct: 0
                },
                {
                    question: "How many Americans believe the moon landing was faked?",
                    options: ["5%", "10%", "20%", "Too many"],
                    correct: 1
                },
                {
                    question: "What do birds actually do according to conspiracy theorists?",
                    options: ["Fly", "Sing", "Spy for the government", "Question their existence"],
                    correct: 2
                },
                {
                    question: "What's inside Area 51 according to believers?",
                    options: ["Aliens", "Secret aircraft", "Nothing interesting", "Your dad who went for cigarettes"],
                    correct: 0
                },
                {
                    question: "How did 9% of Americans think they could beat what in a fight?",
                    options: ["A grizzly bear", "Mike Tyson", "A gorilla", "Their own bad decisions"],
                    correct: 0
                },
                {
                    question: "What do some people think causes contrails from planes?",
                    options: ["Water vapor", "Mind control chemicals", "Aliens", "The government's mixtape"],
                    correct: 1
                },
                {
                    question: "How many people believe the Earth is hollow?",
                    options: ["0.1%", "2%", "5%", "As hollow as their arguments"],
                    correct: 1
                },
                {
                    question: "What do Illuminati conspiracy theorists think is on the dollar bill?",
                    options: ["Hidden symbols", "Secret messages", "Proof of world domination", "Inflation"],
                    correct: 0
                },
                {
                    question: "How many people think lizard people run the government?",
                    options: ["4%", "12%", "20%", "Have you SEEN politicians?"],
                    correct: 1
                },
                {
                    question: "What do some people think 5G towers actually do?",
                    options: ["Provide internet", "Spread disease", "Mind control", "Judge your search history"],
                    correct: 1
                }
            ],
            apocalypse: [
                {
                    question: "How many near-misses has Earth had with asteroids in the last decade?",
                    options: ["5", "20", "100+", "Sleep tight!"],
                    correct: 2
                },
                {
                    question: "What's the Doomsday Clock currently at?",
                    options: ["10 minutes to midnight", "5 minutes", "90 seconds", "Who's counting anymore?"],
                    correct: 2
                },
                {
                    question: "How many nuclear weapons exist globally?",
                    options: ["1,000", "5,000", "13,000+", "Enough to ruin everyone's day"],
                    correct: 2
                },
                {
                    question: "What's the most likely cause of human extinction?",
                    options: ["Asteroids", "Climate change", "Nuclear war", "TikTok"],
                    correct: 1
                },
                {
                    question: "How long would humans survive after a total power grid failure?",
                    options: ["1 week", "1 month", "6 months", "As long as the canned food lasts"],
                    correct: 1
                },
                {
                    question: "What percentage of species that ever lived are now extinct?",
                    options: ["50%", "75%", "99%", "Your turn is coming"],
                    correct: 2
                },
                {
                    question: "How many supervolcanoes are overdue for eruption?",
                    options: ["0", "1", "7", "Yellowstone says hi"],
                    correct: 2
                },
                {
                    question: "What would happen if the Yellowstone supervolcano erupted?",
                    options: ["Local damage", "Regional disaster", "Nuclear winter", "Bad vacation planning"],
                    correct: 2
                },
                {
                    question: "How many people would survive a full-scale nuclear war?",
                    options: ["Billions", "Millions", "Thousands", "The cockroaches"],
                    correct: 3
                },
                {
                    question: "When is the next ice age predicted?",
                    options: ["1,000 years", "10,000 years", "50,000 years", "After humanity stops global warming"],
                    correct: 2
                }
            ]
        };

        let gameState = {
            role: null,
            gameCode: null,
            players: [],
            questions: [],
            currentQuestion: 0,
            topic: '',
            maxPlayers: 4,
            hostName: '',
            playerName: '',
            timer: null,
            timeLeft: 15,
            soloScore: 0,
            soloMode: false
        };

        function getGames() {
            const games = localStorage.getItem('showrovinciGames');
            return games ? JSON.parse(games) : {};
        }

        function saveGames(games) {
            localStorage.setItem('showrovinciGames', JSON.stringify(games));
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function selectRole(role) {
            gameState.role = role;
            if (role === 'host') {
                showScreen('hostSetupScreen');
            } else if (role === 'player') {
                showScreen('playerJoinScreen');
            } else if (role === 'solo') {
                showScreen('soloSetupScreen');
            }
        }

        function generateGameCode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        function startSoloGame() {
            const playerName = document.getElementById('soloPlayerName').value.trim();
            const topic = document.getElementById('soloTopic').value;
            
            if (!playerName) {
                alert('Please enter your name');
                return;
            }

            gameState.soloMode = true;
            gameState.playerName = playerName;
            gameState.topic = topic;
            gameState.questions = [...darkQuestions[topic]];
            gameState.currentQuestion = 0;
            gameState.soloScore = 0;

            const topicNames = {
                existential: 'Existential Dread',
                dark_history: 'Dark History Facts',
                weird_deaths: 'Weird Ways to Die',
                conspiracy: 'Conspiracy Theories',
                apocalypse: 'End of the World'
            };

            document.getElementById('soloTopicDisplay').textContent = topicNames[topic];
            document.getElementById('soloTotalQuestions').textContent = gameState.questions.length;
            document.getElementById('soloScore').textContent = '0';

            showSoloQuestion();
        }

        function showSoloQuestion() {
            const question = gameState.questions[gameState.currentQuestion];
            document.getElementById('soloQuestionNumber').textContent = gameState.currentQuestion + 1;
            document.getElementById('soloQuestionText').textContent = question.question;
            document.getElementById('soloAnswerFeedback').innerHTML = '';
            
            document.getElementById('soloOptions').innerHTML = question.options.map((opt, i) => `
                <button class="option-btn" onclick="selectSoloAnswer(${i})">${opt}</button>
            `).join('');

            showScreen('soloGameScreen');
            startTimer('solo');
        }

        function selectSoloAnswer(optionIndex) {
            clearInterval(gameState.timer);
            
            const question = gameState.questions[gameState.currentQuestion];
            const correct = optionIndex === question.correct;
            
            if (correct) {
                const points = 100 + (gameState.timeLeft * 10);
                gameState.soloScore += points;
                document.getElementById('soloScore').textContent = gameState.soloScore;
            }

            const buttons = document.querySelectorAll('#soloOptions .option-btn');
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === question.correct) {
                    btn.classList.add('correct');
                } else if (i === optionIndex && !correct) {
                    btn.classList.add('incorrect');
                }
            });

            const feedback = correct 
                ? `‚úÖ Correct! +${100 + (gameState.timeLeft * 10)} points`
                : '‚ùå Wrong! Better luck in the afterlife!';
            
            document.getElementById('soloAnswerFeedback').innerHTML = feedback;

            setTimeout(() => {
                gameState.currentQuestion++;
                if (gameState.currentQuestion < gameState.questions.length) {
                    showSoloQuestion();
                } else {
                    showSoloResults();
                }
            }, 3000);
        }

        function showSoloResults() {
            const scoreboard = document.getElementById('finalScoreboard');
            const maxScore = gameState.questions.length * 250; // Max possible score
            const percentage = Math.round((gameState.soloScore / maxScore) * 100);
            
            let message = '';
            if (percentage >= 90) message = 'üé≠ Dark Genius! You know too much...';
            else if (percentage >= 70) message = 'üíÄ Impressively Morbid!';
            else if (percentage >= 50) message = 'üëª Could be worse... literally';
            else message = '‚ö∞Ô∏è At least you tried before dying';

            scoreboard.innerHTML = `
                <div class="scoreboard-item">
                    <span class="rank">${message}</span>
                </div>
                <div class="scoreboard-item">
                    <span class="player-name">${gameState.playerName}</span>
                    <span class="player-score">${gameState.soloScore} / ${maxScore} pts</span>
                </div>
                <div class="scoreboard-item">
                    <span style="font-size: 0.9em;">Accuracy: ${percentage}%</span>
                </div>
            `;

            showScreen('resultsScreen');
        }

        function createGame() {
            const hostName = document.getElementById('hostName').value.trim();
            const topic = document.getElementById('gameTopic').value.trim();
            const maxPlayers = parseInt(document.getElementById('maxPlayers').value);

            if (!hostName || !topic) {
                alert('Please fill in all fields');
                return;
            }

            gameState.hostName = hostName;
            gameState.topic = topic;
            gameState.maxPlayers = maxPlayers;
            gameState.gameCode = generateGameCode();

            const games = getGames();
            games[gameState.gameCode] = {
                host: hostName,
                topic: topic,
                maxPlayers: maxPlayers,
                players: [],
                questions: [],
                started: false,
                currentQuestion: 0
            };
            saveGames(games);

            document.getElementById('displayGameCode').textContent = gameState.gameCode;
            document.getElementById('displayTopic').textContent = topic;
            document.getElementById('maxPlayerCount').textContent = maxPlayers;

            showScreen('hostLobbyScreen');
            updateLobby();
        }

        function joinGame() {
            const playerName = document.getElementById('playerName').value.trim();
            const gameCode = document.getElementById('gameCode').value.trim();

            if (!playerName || !gameCode) {
                alert('Please fill in all fields');
                return;
            }

            const games = getGames();
            const game = games[gameCode];
            
            if (!game) {
                alert('Game not found');
                return;
            }

            if (game.players.length >= game.maxPlayers) {
                alert('Game is full!');
                return;
            }

            if (game.started) {
                alert('Game already started!');
                return;
            }

            if (game.players.some(p => p.name === playerName)) {
                alert('Name already taken!');
                return;
            }

            gameState.playerName = playerName;
            gameState.gameCode = gameCode;
            gameState.topic = game.topic;

            game.players.push({
                name: playerName,
                score: 0,
                answers: []
            });
            saveGames(games);

            showScreen('playerWaitingScreen');
            updatePlayerWaiting();
        }

        function updateLobby() {
            const games = getGames();
            const game = games[gameState.gameCode];
            
            if (!game) return;
            
            document.getElementById('playerCount').textContent = game.players.length;
            document.getElementById('lobbyPlayersList').innerHTML = game.players.map(p => `
                <div class="player-item">
                    <span class="player-name">üéÆ ${p.name}</span>
                    <span style="color: #43e97b;">‚úì Ready</span>
                </div>
            `).join('');

            document.getElementById('startGameBtn').disabled = game.players.length < 2;

            if (!game.started) {
                setTimeout(updateLobby, 1000);
            }
        }

        function updatePlayerWaiting() {
            const games = getGames();
            const game = games[gameState.gameCode];
            
            if (!game) return;
            
            document.getElementById('waitingPlayersList').innerHTML = game.players.map(p => `
                <div class="player-item">
                    <span class="player-name">üéÆ ${p.name}</span>
                </div>
            `).join('');

            if (game.started && game.questions.length > 0) {
                gameState.questions = game.questions;
                gameState.currentQuestion = game.currentQuestion;
                showPlayerQuestion();
            } else {
                setTimeout(updatePlayerWaiting, 1000);
            }
        }

        function startQuestionCreation() {
            document.getElementById('creationTopic').textContent = gameState.topic;
            showScreen('questionCreationScreen');
        }

        function addQuestion() {
            const questionText = document.getElementById('questionText').value.trim();
            const options = [
                document.getElementById('option0').value.trim(),
                document.getElementById('option1').value.trim(),
                document.getElementById('option2').value.trim(),
                document.getElementById('option3').value.trim()
            ];
            
            const correctAnswer = document.querySelector('input[name="correctAnswer"]:checked');

            if (!questionText || options.some(o => !o) || !correctAnswer) {
                alert('Please fill all fields and select correct answer');
                return;
            }

            gameState.questions.push({
                question: questionText,
                options: options,
                correct: parseInt(correctAnswer.value)
            });
            
            const games = getGames();
            games[gameState.gameCode].questions = gameState.questions;
            saveGames(games);

            document.getElementById('questionText').value = '';
            document.getElementById('option0').value = '';
            document.getElementById('option1').value = '';
            document.getElementById('option2').value = '';
            document.getElementById('option3').value = '';
            document.querySelectorAll('input[name="correctAnswer"]').forEach(r => r.checked = false);

            updateQuestionsDisplay();
        }

        function updateQuestionsDisplay() {
            document.getElementById('questionCount').textContent = gameState.questions.length;
            document.getElementById('questionsDisplay').innerHTML = gameState.questions.map((q, i) => `
                <div class="question-item">
                    <strong>Q${i + 1}:</strong> ${q.question}<br>
                    <small>Correct: ${q.options[q.correct]}</small>
                </div>
            `).join('');

            document.getElementById('startGameBtnFinal').disabled = gameState.questions.length < 5;
        }

        function startGame() {
            if (gameState.questions.length < 5) {
                alert('Need at least 5 questions');
                return;
            }

            const games = getGames();
            games[gameState.gameCode].started = true;
            games[gameState.gameCode].currentQuestion = 0;
            saveGames(games);
            
            gameState.currentQuestion = 0;
            showHostQuestion();
        }

        function showHostQuestion() {
            const question = gameState.questions[gameState.currentQuestion];
            document.getElementById('hostQuestionNumber').textContent = gameState.currentQuestion + 1;
            document.getElementById('hostQuestionText').textContent = question.question;
            document.getElementById('nextQuestionBtn').style.display = 'none';
            document.getElementById('showResultsBtn').style.display = 'none';
            
            showScreen('hostGameScreen');
            startTimer('host');
            monitorPlayerAnswers();
        }

        function showPlayerQuestion() {
            const question = gameState.questions[gameState.currentQuestion];
            document.getElementById('playerQuestionNumber').textContent = gameState.currentQuestion + 1;
            document.getElementById('playerQuestionText').textContent = question.question;
            document.getElementById('answerFeedback').innerHTML = '';
            
            document.getElementById('playerOptions').innerHTML = question.options.map((opt, i) => `
                <button class="option-btn" onclick="selectAnswer(${i})">${opt}</button>
            `).join('');

            showScreen('playerGameScreen');
            startTimer('player');
        }

        function startTimer(role) {
            gameState.timeLeft = 15;
            const timerElement = document.getElementById(role + 'Timer');
            
            clearInterval(gameState.timer);
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                timerElement.textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 5) {
                    timerElement.classList.add('warning');
                } else {
                    timerElement.classList.remove('warning');
                }
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    if (role === 'player') {
                        const games = getGames();
                        const game = games[gameState.gameCode];
                        const player = game.players.find(p => p.name === gameState.playerName);
                        
                        if (!player.answers.some(a => a.question === gameState.currentQuestion)) {
                            selectAnswer(-1);
                        }
                    }
                    if (role === 'solo') {
                        selectSoloAnswer(-1);
                    }
                }
            }, 1000);
        }

        function selectAnswer(optionIndex) {
            clearInterval(gameState.timer);
            
            const question = gameState.questions[gameState.currentQuestion];
            const correct = optionIndex === question.correct;
            
            const games = getGames();
            const game = games[gameState.gameCode];
            const player = game.players.find(p => p.name === gameState.playerName);
            
            if (player.answers.some(a => a.question === gameState.currentQuestion)) {
                return;
            }
            
            player.answers.push({
                question: gameState.currentQuestion,
                answer: optionIndex,
                correct: correct,
                time: gameState.timeLeft
            });
            
            if (correct) {
                player.score += 100 + (gameState.timeLeft * 10);
            }
            
            saveGames(games);

            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === question.correct) {
                    btn.classList.add('correct');
                } else if (i === optionIndex && !correct) {
                    btn.classList.add('incorrect');
                }
            });

            document.getElementById('answerFeedback').innerHTML = correct 
                ? `‚úÖ Correct! +${100 + (gameState.timeLeft * 10)} points`
                : (optionIndex === -1 ? '‚è±Ô∏è Time\'s up!' : '‚ùå Incorrect!');

            setTimeout(checkNextQuestion, 3000);
        }

        function checkNextQuestion() {
            const games = getGames();
            const game = games[gameState.gameCode];
            
            if (game.currentQuestion > gameState.currentQuestion) {
                gameState.currentQuestion = game.currentQuestion;
                if (gameState.currentQuestion < gameState.questions.length) {
                    showPlayerQuestion();
                } else {
                    showPlayerResults();
                }
            } else {
                setTimeout(checkNextQuestion, 1000);
            }
        }

        function monitorPlayerAnswers() {
            const games = getGames();
            const game = games[gameState.gameCode];
            
            if (!game) return;
            
            const allAnswered = game.players.every(p => 
                p.answers.some(a => a.question === gameState.currentQuestion)
            );

            document.getElementById('hostAnswersDisplay').innerHTML = game.players.map(p => {
                const answered = p.answers.some(a => a.question === gameState.currentQuestion);
                return `
                    <div class="player-item">
                        <span class="player-name">${p.name}</span>
                        <span>${answered ? '‚úÖ Answered' : '‚è≥ Thinking...'}</span>
                    </div>
                `;
            }).join('');

            if (allAnswered || gameState.timeLeft <= 0) {
                clearInterval(gameState.timer);
                setTimeout(() => {
                    if (gameState.currentQuestion < gameState.questions.length - 1) {
                        document.getElementById('nextQuestionBtn').style.display = 'block';
                    } else {
                        document.getElementById('showResultsBtn').style.display = 'block';
                    }
                }, 1000);
            } else {
                setTimeout(monitorPlayerAnswers, 500);
            }
        }

        function nextQuestion() {
            gameState.currentQuestion++;
            
            const games = getGames();
            games[gameState.gameCode].currentQuestion = gameState.currentQuestion;
            saveGames(games);
            
            showHostQuestion();
        }

        function showResults() {
            const games = getGames();
            const game = games[gameState.gameCode];
            
            const sortedPlayers = [...game.players].sort((a, b) => b.score - a.score);
            
            document.getElementById('finalScoreboard').innerHTML = sortedPlayers.map((p, i) => {
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                return `
                    <div class="scoreboard-item">
                        <span class="rank">${medals[i] || ''} #${i + 1}</span>
                        <span class="player-name">${p.name}</span>
                        <span class="player-score">${p.score} pts</span>
                    </div>
                `;
            }).join('');

            showScreen('resultsScreen');
        }

        function showPlayerResults() {
            const checkResults = setInterval(() => {
                const games = getGames();
                const game = games[gameState.gameCode];
                
                if (!game) {
                    clearInterval(checkResults);
                    return;
                }
                
                const allFinished = game.players.every(p => 
                    p.answers.length >= gameState.questions.length
                );
                
                if (allFinished) {
                    clearInterval(checkResults);
                    showResults();
                }
            }, 1000);
        }
    </script>
</body>
</html>
